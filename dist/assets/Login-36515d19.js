import{M as Q,a as W,u as X,b as z,r as t,c as K,j as e,C as k,p as Y,E as u,L as y,g as Z,d as ee,e as se,f as ae,s as te,R as C,h as oe,i as re,Q as E}from"./index-f542c721.js";import{p as ne}from"./password-icon-c9c96b4d.js";import{A as ce,S as le,L as ie}from"./LoginType-5efdf988.js";import{c as me,a as M}from"./index.esm-822dde25.js";import{o as de}from"./yup-f45bf39b.js";import{S as he}from"./SubmitButton-265ed07f.js";import{R as ue}from"./recaptcha-wrapper-0c87ddc3.js";import"./index-27ed1d6c.js";const pe=me().shape({password:M().required("Password is required"),phone_number:M().required("Mobile number is required").matches(/^[0-9]+$/,"Mobile number must contain only digits").min(12,Q).max(15,W)}),Ie=()=>{const c=X(),m=z(),[p,O]=t.useState(!1),[n,l]=t.useState({show:!1,msg:""}),[g,d]=t.useState(!1),[P,D]=t.useState("Login"),[V,A]=t.useState({id:""}),[f,b]=t.useState(!1),[ge,T]=t.useState(!1),U=localStorage.getItem("selectedRole"),q=localStorage.getItem("token"),x=t.useRef(),B=q?U:!0,{handleSubmit:F,control:j,setValue:S,watch:w,formState:{errors:i}}=K({resolver:de(pe)});t.useEffect(()=>{const s=localStorage.getItem("phone_number"),o=localStorage.getItem("password");s&&o&&(S("phone_number",s),S("password",o),b(!0))},[]);const _=()=>{D("SelectUser")},G=s=>{T(!0),l({show:!1,msg:""}),console.log("Captcha value:",s)},$=s=>{if(x.current.getValue().length<=0){l({show:!0,msg:ee});return}if(n.show)return;const h={...s,phone_number:"+"+s.phone_number};d(!0),se.post(ae,h).then(a=>{var I,R,L,N;A({id:(I=a.data.data)==null?void 0:I.id});const r=(L=(R=a.data)==null?void 0:R.data)!=null&&L.groups?(N=a.data.data.groups[0])==null?void 0:N.name:null;localStorage.setItem("token",a.data.data.access),localStorage.setItem("refresh_token",a.data.data.refresh),localStorage.setItem("user_id",a.data.data.id),localStorage.setItem("selectedRole",r),localStorage.setItem("phone_number",a.data.data.phone_number),m(te(a.data.data.phone_number)),r?r===C.jobseeker?(m(oe(a.data.data)),c("/job-seeker/dashboard")):(m(re(a.data.data)),c("/job-recruiter/dashboard")):_(),E.success("Login successfully"),d(!1)}).catch(a=>{var r;d(!1),((r=a==null?void 0:a.response)==null?void 0:r.status)===400?l({show:!0,msg:a.response.data.message}):E.error("something went wrong"),console.log(a.message,"error in the login")})},v=()=>{n.show&&l({show:!1,msg:""})},H=s=>{s===C.jobseeker?c("/job-seeker/dashboard"):c("/job-recruiter/dashboard")},J=s=>{s.target.checked?(localStorage.setItem("phone_number",w("phone_number")),localStorage.setItem("password",w("password"))):(localStorage.removeItem("phone_number"),localStorage.removeItem("password")),b(!f)};return e.jsx(e.Fragment,{children:P==="Login"&&B?e.jsxs(ce,{children:[e.jsx("h2",{children:"Login"}),e.jsxs("div",{className:"form-wrap",children:[e.jsxs("form",{name:"login-form",onSubmit:F($),children:[e.jsxs("div",{className:"fieldset",children:[e.jsx(k,{name:"phone_number",control:j,defaultValue:"",render:({field:s})=>e.jsx("input",{...s,onChange:o=>{v();const h=o.target.value.replace(/[^0-9]/g,"");s.onChange(h)},className:"form-control input-icon phone-number",placeholder:"Phone number eg: 919898989898","aria-label":"Has Error","aria-invalid":"true","aria-errormessage":"error-message-phone"})}),e.jsx("span",{className:"input-field-icon",children:e.jsx("img",{src:Y})}),i.phone_number&&e.jsx(u,{id:"error-message-phone",msg:i.phone_number.message})]}),e.jsxs("div",{className:"fieldset",children:[e.jsx(k,{name:"password",control:j,defaultValue:"",render:({field:s})=>e.jsx("div",{children:e.jsx("input",{...s,onChange:o=>{v(),s.onChange(o)},placeholder:"Password",className:"password form-control input-icon",type:p?"text":"password","aria-label":"Has Error","aria-invalid":"true","aria-errormessage":"error-message-pasword"})})}),e.jsx("i",{className:`far icon-position ${p?"fa-eye fa-eye-slash":"fa-eye-slash"}`,style:{cursor:"pointer"},onClick:()=>O(s=>!s)}),e.jsx("span",{className:"input-field-icon",children:e.jsx("img",{src:ne})}),i.password&&e.jsx(u,{id:"error-message-pasword",msg:i.password.message})]}),n.show&&e.jsx(u,{msg:n.msg}),e.jsxs("div",{className:"fieldset d-flex align-items-center justify-content-between remember my-3",children:[e.jsxs("div",{className:"custom_check position-relative me-2",children:[e.jsx("input",{type:"checkbox",id:"rememberme",checked:f,onChange:s=>J(s)}),e.jsx("span",{}),e.jsx("label",{className:"form-check-label ms-1",htmlFor:"rememberme",children:"Remember me"})]}),e.jsx(y,{to:"/forgot-password",children:"Forgot password?"})]}),e.jsx("div",{className:"fieldset mt-2 mb-2",children:e.jsx(he,{loader:g,disabled:n.show||g,contentText:"Login"})})]}),e.jsx("div",{className:"or-with",children:e.jsx("span",{children:"Or Login with"})}),e.jsx(le,{afterAPISuccess:_}),e.jsx("div",{className:"d-flex justify-content-center mt-2",children:e.jsx(ue,{ref:x,sitekey:Z,onChange:G})}),e.jsxs("p",{children:["Donâ€™t have an account? ",e.jsx(y,{to:"/register",children:" Sign Up"}),"."]})]})]}):e.jsx(ie,{afterSelectUserType:H,userID:V.id})})};export{Ie as default};
